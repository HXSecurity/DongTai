{"type":36,"version":"v3","detail":{"agentId":374,"protocol":"HTTP/1.1","scheme":"http","method":"GET","secure":false,"url":"http://localhost:8001/api/cmd-injection/unsafe/runtime-exec","uri":"/api/cmd-injection/unsafe/runtime-exec","clientIp":"127.0.0.1","queryString":"cmd=whoami","reqHeader":"c2VjLWZldGNoLW1vZGU6Y29ycwpyZWZlcmVyOmh0dHA6Ly9sb2NhbGhvc3Q6ODAwMS9zd2FnZ2VyLXVpL2luZGV4Lmh0bWwKc2VjLWZldGNoLXNpdGU6c2FtZS1vcmlnaW4KYWNjZXB0LWxhbmd1YWdlOnpoLUNOLHpoO3E9MC45CmR0LXRyYWNlaWQ6YzVkOTA4NmFmYTc1NDBhZTgzNmM4ZGY0OWE5YzFkOTQuMC4wLjFlYmQxYTljNDE2MzNjNjkKYWNjZXB0OmFwcGxpY2F0aW9uL2pzb24Kc2VjLWNoLXVhOiJOb3QvQSlCcmFuZCI7dj0iOTkiLCAiR29vZ2xlIENocm9tZSI7dj0iMTE1IiwgIkNocm9taXVtIjt2PSIxMTUiCnNlYy1jaC11YS1tb2JpbGU6PzAKc2VjLWNoLXVhLXBsYXRmb3JtOiJtYWNPUyIKaG9zdDpsb2NhbGhvc3Q6ODAwMQpjb25uZWN0aW9uOmtlZXAtYWxpdmUKYWNjZXB0LWVuY29kaW5nOmd6aXAsIGRlZmxhdGUsIGJyCnVzZXItYWdlbnQ6TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExNS4wLjAuMCBTYWZhcmkvNTM3LjM2CnNlYy1mZXRjaC1kZXN0OmVtcHR5Cg==","reqBody":"","resHeader":"SFRUUC8xLjEgMjAwCktlZXAtQWxpdmU6dGltZW91dD02MApDb25uZWN0aW9uOmtlZXAtYWxpdmUKRGF0ZTpNb24sIDA3IEF1ZyAyMDIzIDAzOjQ5OjM1IEdNVApEb25nVGFpOnYxLjEyLjAKQ29udGVudC1MZW5ndGg6MTEwCkNvbnRlbnQtVHlwZTphcHBsaWNhdGlvbi9qc29uCg==","resBody":"eyJjb2RlIjowLCJlbnRyeXBvaW50IjoiR0VUIC9hcGkvY21kLWluamVjdGlvbi91bnNhZmUvcnVu\ndGltZS1leGVjIiwiY29udGVudCI6InNoOiBhYm1pOiBjb21tYW5kIG5vdCBmb3VuZFxuIn0=","contextPath":"","replayRequest":false,"pool":[{"invokeId":15,"policyType":"source","source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getHeaders","signature":"javax.servlet.http.HttpServletRequest.getHeaders(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getHeaderValues","callerLineNumber":135,"sourceHash":[],"targetHash":[2053241162],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@38248abc]52","parameterValues":[{"index":"P1","value":"[Accept]*6"}],"retValue":"[org.apache.tomcat.util.http.ValuesEnumerator@7a61f94a]*53","targetRange":[{"hash":2053241162,"ranges":[{"name":"untrusted","start":0,"stop":53},{"name":"cross-site","start":0,"stop":53}]}]},{"invokeId":16,"policyType":"propagator","source":false,"originClassName":"org.apache.tomcat.util.http.ValuesEnumerator","className":"java.util.Enumeration","methodName":"nextElement","signature":"java.util.Enumeration.nextElement()","callerClass":"java.util.Collections","callerMethod":"list","callerLineNumber":5294,"sourceHash":[2053241162],"targetHash":[-188295457403430794],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[org.apache.tomcat.util.http.ValuesEnumerator@7a61f94a]*53","retValue":"[application/json]*16","targetRange":[{"hash":-188295457403430794,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":17,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int)","callerClass":"org.springframework.util.MimeTypeUtils","callerMethod":"tokenize","callerLineNumber":319,"sourceHash":[-188295457403430794],"targetHash":[-188295457403430794],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[application/json]*16","retValue":"[application/json]*16","targetRange":[{"hash":-188295457403430794,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":18,"policyType":"source","source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getParameterValues","signature":"javax.servlet.http.HttpServletRequest.getParameterValues(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getParameterValues","callerLineNumber":153,"sourceHash":[],"targetHash":[-3387220120988899024],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@38248abc]52","parameterValues":[{"index":"P1","value":"[cmd]*3"}],"retValue":"[whoami ]*7","targetRange":[{"hash":-3387220120988899024,"ranges":[{"name":"untrusted","start":0,"stop":6},{"name":"cross-site","start":0,"stop":6}]}]},{"invokeId":19,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"<init>","signature":"java.lang.StringBuilder.<init>(java.lang.String)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":25,"sourceHash":[-3387220120988899024],"targetHash":[304979025],"taintPosition":{"source":["P1"],"target":["O"]},"objValue":"[whoami]*6","parameterValues":[{"index":"P1","value":"[whoami]*6"}],"targetRange":[{"hash":304979025,"ranges":[{"name":"untrusted","start":0,"stop":6},{"name":"cross-site","start":0,"stop":6}]}]},{"invokeId":20,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"delete","signature":"java.lang.StringBuilder.delete(int,int)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":26,"sourceHash":[304979025],"targetHash":[304979025],"taintPosition":{"source":["O"],"target":["O"]},"objValue":"[oami]*4","targetRange":[{"hash":304979025,"ranges":[{"name":"untrusted","start":0,"stop":4},{"name":"cross-site","start":0,"stop":4}]}]},{"invokeId":21,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"replace","signature":"java.lang.StringBuilder.replace(int,int,java.lang.String)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":27,"sourceHash":[304979025],"targetHash":[304979025],"taintPosition":{"source":["P3","O"],"target":["O"]},"objValue":"[abmi]*4","parameterValues":[{"index":"P3","value":"[ab]2"}],"targetRange":[{"hash":304979025,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":22,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"toString","signature":"java.lang.StringBuilder.toString()","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":30,"sourceHash":[304979025],"targetHash":[12830739712815242],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[abmi]*4","retValue":"[abmi]*4","targetRange":[{"hash":12830739712815242,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4},{"name":"validated","start":0,"stop":4}]}]},{"invokeId":23,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getChars","signature":"java.lang.String.getChars(int,int,char[],int)","callerClass":"java.io.BufferedWriter","callerMethod":"write","callerLineNumber":226,"sourceHash":[12830739712815242],"targetHash":[1390488317],"taintPosition":{"source":["O"],"target":["P3"]},"objValue":"[abmi]*4","parameterValues":[{"index":"P3","value":"[[C@52e12afd]*11"}],"targetRange":[{"hash":1390488317,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":24,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"append","signature":"java.lang.StringBuilder.append(java.lang.String)","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":13,"sourceHash":[12830739712815242],"targetHash":[500952262],"taintPosition":{"source":["P1"],"target":["O"]},"objValue":"[sh -c abmi]*10","parameterValues":[{"index":"P1","value":"[abmi]*4"}],"targetRange":[{"hash":500952262,"ranges":[{"name":"untrusted","start":8,"stop":10},{"name":"cross-site","start":8,"stop":10}]}]},{"invokeId":25,"policyType":"propagator","source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"toString","signature":"java.lang.StringBuilder.toString()","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":13,"sourceHash":[500952262],"targetHash":[-1420539627220844070],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[sh -c abmi]*10","targetRange":[{"hash":-1420539627220844070,"ranges":[{"name":"untrusted","start":8,"stop":10},{"name":"cross-site","start":8,"stop":10}]}]},{"invokeId":26,"policyType":"sink","source":false,"originClassName":"java.lang.Runtime","className":"java.lang.Runtime","methodName":"exec","signature":"java.lang.Runtime.exec(java.lang.String)","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":18,"sourceHash":[-1420539627220844070],"targetHash":[],"taintPosition":{"source":["P1"]},"objValue":"[java.lang.Runtime@14fe21c1]26","parameterValues":[{"index":"P1","value":"[sh -c abmi]*10"}],"stacks":["java.lang.Runtime.exec(Runtime.java)","app.iast.common.vul.CmdInjection.runtimeExec(CmdInjection.java:18)","app.iast.service.http.vul.controller.CmdInjectionController.unsafeRuntimeExec(CmdInjectionController.java:30)","sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)","sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","java.lang.reflect.Method.invoke(Method.java:498)","org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)","org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)","org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)","org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)","org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)","org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)","org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)","org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)","org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)","org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)","javax.servlet.http.HttpServlet.service(HttpServlet.java:626)","org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)","javax.servlet.http.HttpServlet.service(HttpServlet.java:733)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)","org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)","org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)","org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)","org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)","org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)","org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:346)","org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)","org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)","org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:887)","org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1684)","org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)","java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)","java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)","org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)","java.lang.Thread.run(Thread.java:748)"]},{"invokeId":27,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627220844070],"targetHash":[15759686320708],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[sh]*2","targetRange":[{"hash":15759686320708,"ranges":[]}]},{"invokeId":28,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627220844070],"targetHash":[6416722650463],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[-c]*2","targetRange":[{"hash":6416722650463,"ranges":[]}]},{"invokeId":29,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627220844070],"targetHash":[12830739770860052],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[abmi]*4","targetRange":[{"hash":12830739770860052,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":30,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"start","callerLineNumber":74,"sourceHash":[6416722650463],"targetHash":[53126971],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[-c]*2","retValue":"[[B@32aa73b]*10","targetRange":[{"hash":53126971,"ranges":[]}]},{"invokeId":31,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"start","callerLineNumber":74,"sourceHash":[12830739770860052],"targetHash":[1600476792],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[abmi]*4","retValue":"[[B@5f655678]*11","targetRange":[{"hash":1600476792,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":32,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"toCString","callerLineNumber":50,"sourceHash":[15759686320708],"targetHash":[221249735],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh]*2","retValue":"[[B@d3000c7]*10","targetRange":[{"hash":221249735,"ranges":[]}]},{"invokeId":33,"policyType":"validator","source":false,"originClassName":"app.iast.common.vul.CmdInjection","className":"app.iast.common.vul.CmdInjection","methodName":"runtimeExec","signature":"app.iast.common.vul.CmdInjection.runtimeExec(java.lang.String)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":30,"sourceHash":[12830739712815242],"targetHash":[],"taintPosition":{},"objValue":"","sourceRange":[{"hash":12830739712815242,"ranges":[{"name":"validated","start":0,"stop":4}]}]},{"invokeId":34,"policyType":"source","source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getHeaders","signature":"javax.servlet.http.HttpServletRequest.getHeaders(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getHeaderValues","callerLineNumber":135,"sourceHash":[],"targetHash":[1599151117],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@38248abc]52","parameterValues":[{"index":"P1","value":"[Accept]*6"}],"retValue":"[org.apache.tomcat.util.http.ValuesEnumerator@5f511c0d]*53","targetRange":[{"hash":1599151117,"ranges":[{"name":"untrusted","start":0,"stop":53},{"name":"cross-site","start":0,"stop":53}]}]},{"invokeId":35,"policyType":"propagator","source":false,"originClassName":"org.apache.tomcat.util.http.ValuesEnumerator","className":"java.util.Enumeration","methodName":"nextElement","signature":"java.util.Enumeration.nextElement()","callerClass":"java.util.Collections","callerMethod":"list","callerLineNumber":5294,"sourceHash":[1599151117],"targetHash":[-188295457403430794],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[org.apache.tomcat.util.http.ValuesEnumerator@5f511c0d]*53","retValue":"[application/json]*16","targetRange":[{"hash":-188295457403430794,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":36,"policyType":"propagator","source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int)","callerClass":"org.springframework.util.MimeTypeUtils","callerMethod":"tokenize","callerLineNumber":319,"sourceHash":[-188295457403430794],"targetHash":[-188295457403430794],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[application/json]*16","retValue":"[application/json]*16","targetRange":[{"hash":-188295457403430794,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]}],"traceId":"c5d9086afa7540ae836c8df49a9c1d94.0.0.1ebd1a9c41633c69"}}